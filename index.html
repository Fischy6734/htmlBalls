<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online HTML Editor</title>
    <link rel="icon" type="image/x-icon" href="icon/icon.png">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        header {
            margin-bottom: 20px;
        }
        section {
            margin-bottom: 20px;
        }
        textarea, input[type="file"] {
            width: 100%;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 15px;
            margin-right: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<header>
    <h1>Online HTML Editor</h1>
</header>

<section>
    <h2>HTML</h2>
    <textarea id="htmlInput" placeholder="Write your HTML code here..."></textarea>
    <input type="file" id="htmlFileInput" accept=".html">
</section>

<section>
    <h2>CSS</h2>
    <input type="text" id="cssFileName" placeholder="CSS File Name (without extension)">
    <textarea id="cssInput" placeholder="Write your CSS code here..."></textarea>
    <input type="file" id="cssFileInput" accept=".css">
</section>

<section>
    <h2>JavaScript</h2>
    <input type="text" id="jsFileName" placeholder="JavaScript File Name (without extension)">
    <textarea id="jsInput" placeholder="Write your JavaScript code here..."></textarea>
    <input type="file" id="jsFileInput" accept=".js">
</section>

<section>
    <h2>Custom Font</h2>
    <input type="file" id="fontFileInput" accept=".otf">
</section>

<button id="downloadBtn">Download Files</button>
<button id="addMoreBtn">Add More HTML/CSS</button>

<section>
    <h2>Output</h2>
    <iframe id="outputFrame" style="width: 100%; height: 300px; border: 1px solid #ccc;"></iframe>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script>
    // Save progress to local storage
    function saveProgress() {
        localStorage.setItem('htmlContent', document.getElementById('htmlInput').value);
        localStorage.setItem('cssContent', document.getElementById('cssInput').value);
        localStorage.setItem('jsContent', document.getElementById('jsInput').value);
        localStorage.setItem('cssFileName', document.getElementById('cssFileName').value);
        localStorage.setItem('jsFileName', document.getElementById('jsFileName').value);
    }

    // Load progress from local storage
    function loadProgress() {
        document.getElementById('htmlInput').value = localStorage.getItem('htmlContent') || '';
        document.getElementById('cssInput').value = localStorage.getItem('cssContent') || '';
        document.getElementById('jsInput').value = localStorage.getItem('jsContent') || '';
        document.getElementById('cssFileName').value = localStorage.getItem('cssFileName') || '';
        document.getElementById('jsFileName').value = localStorage.getItem('jsFileName') || '';
    }

    // Update output frame
    function updateOutput() {
        const html = document.getElementById('htmlInput').value;
        const css = `<style>${document.getElementById('cssInput').value}</style>`;
        const js = document.getElementById('jsInput').value;
        const outputFrame = document.getElementById('outputFrame').contentWindow.document;
        outputFrame.open();
        outputFrame.write(html + css + `<script>${js}<\/script>`);
        outputFrame.close();
    }

    // Handle file imports
    function handleFileInput(fileInput, callback) {
        const file = fileInput.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(event) {
                callback(event.target.result);
            };
            reader.readAsText(file);
        }
    }

    document.getElementById('htmlFileInput').addEventListener('change', function() {
        handleFileInput(this, function(content) {
            document.getElementById('htmlInput').value = content;
            updateOutput();
        });
    });

    document.getElementById('cssFileInput').addEventListener('change', function() {
        handleFileInput(this, function(content) {
            document.getElementById('cssInput').value = content;
            updateOutput();
        });
    });

    document.getElementById('jsFileInput').addEventListener('change', function() {
        handleFileInput(this, function(content) {
            document.getElementById('jsInput').value = content;
            updateOutput();
        });
    });

    // Download files
    document.getElementById('downloadBtn').addEventListener('click', () => {
        saveProgress();
        const htmlContent = document.getElementById('htmlInput').value;
        const cssContent = document.getElementById('cssInput').value;
        const jsContent = document.getElementById('jsInput').value;
        const cssFileName = document.getElementById('cssFileName').value || 'style';
        const jsFileName = document.getElementById('jsFileName').value || 'script';
        const fontFileInput = document.getElementById('fontFileInput').files[0];

        const zip = new JSZip();
        zip.file('index.html', htmlContent);
        if (cssContent) zip.file(`${cssFileName}.css`, cssContent);
        if (jsContent) zip.file(`${jsFileName}.js`, jsContent);
        if (fontFileInput) {
            zip.file(fontFileInput.name, fontFileInput);
        }

        // Add caption to HTML
        const caption = "<!-- Made with HTML balls -->\n";
        zip.file('index.html', caption + htmlContent);

        zip.generateAsync({ type: "blob" }).then(function(content) {
            const a = document.createElement('a');
            a.href = URL.createObjectURL(content);
            a.download = 'project.zip';
            a.click();
        });
    });

    // Add more HTML/CSS functionality (placeholder)
    document.getElementById('addMoreBtn').addEventListener('click', () => {
        // Placeholder for adding more HTML/CSS sections
        alert('Add more functionality here.');
    });

    // Event listeners for input changes
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.addEventListener('input', updateOutput);
    });

    // Load progress on page load
    window.onload = loadProgress;
    window.onbeforeunload = saveProgress;
</script>

</body>
</html>
