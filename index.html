<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online HTML Editor</title>
    <link rel="icon" type="image/x-icon" href="icon/icon.png">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #1e1e1e;
            color: #f4f4f4;
        }
        header {
            margin-bottom: 20px;
        }
        section {
            margin-bottom: 20px;
        }
        textarea, input[type="file"] {
            width: 100%;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 15px;
            margin-right: 10px;
            cursor: pointer;
        }
        #sidebar {
            width: 200px;
            float: left;
            margin-right: 20px;
        }
        #main-content {
            overflow: hidden;
        }
        #outputFrame {
            width: 100%;
            height: 300px;
            border: 1px solid #ccc;
        }
        .project-title {
            cursor: pointer;
        }
    </style>
</head>
<body>

<header>
    <h1>Online HTML Editor</h1>
    <button id="darkModeToggle">Toggle Dark Mode</button>
</header>

<div id="sidebar">
    <h2>Projects</h2>
    <div id="projectList"></div>
    <button id="newProjectBtn">New Project</button>
</div>

<div id="main-content">
    <section>
        <h2>HTML</h2>
        <textarea id="htmlInput" placeholder="Write your HTML code here..."></textarea>
    </section>

    <section>
        <h2>CSS</h2>
        <input type="text" id="cssFileName" placeholder="CSS File Name (without extension)">
        <textarea id="cssInput" placeholder="Write your CSS code here..."></textarea>
        <input type="file" id="fontInput" accept=".otf" />
        <button id="addFontBtn">Add OTF Font</button>
    </section>

    <section>
        <h2>JavaScript</h2>
        <input type="text" id="jsFileName" placeholder="JavaScript File Name (without extension)">
        <textarea id="jsInput" placeholder="Write your JavaScript code here..."></textarea>
    </section>

    <button id="downloadBtn">Download Files</button>
    <button id="importBtn">Import Files</button>
    <button id="addMoreBtn">Add More HTML/CSS</button>

    <section>
        <h2>Output</h2>
        <iframe id="outputFrame"></iframe>
    </section>
</div>

<script>
    // Toggle Dark Mode
    document.getElementById('darkModeToggle').addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
    });

    // Save progress to local storage
    function saveProgress() {
        const projectName = document.getElementById('projectTitle').innerText || 'Untitled';
        localStorage.setItem(`${projectName}_html`, document.getElementById('htmlInput').value);
        localStorage.setItem(`${projectName}_css`, document.getElementById('cssInput').value);
        localStorage.setItem(`${projectName}_js`, document.getElementById('jsInput').value);
        localStorage.setItem(`${projectName}_cssFileName`, document.getElementById('cssFileName').value);
        localStorage.setItem(`${projectName}_jsFileName`, document.getElementById('jsFileName').value);
    }

    // Load progress from local storage
    function loadProgress(projectName) {
        document.getElementById('htmlInput').value = localStorage.getItem(`${projectName}_html`) || '';
        document.getElementById('cssInput').value = localStorage.getItem(`${projectName}_css`) || '';
        document.getElementById('jsInput').value = localStorage.getItem(`${projectName}_js`) || '';
        document.getElementById('cssFileName').value = localStorage.getItem(`${projectName}_cssFileName`) || '';
        document.getElementById('jsFileName').value = localStorage.getItem(`${projectName}_jsFileName`) || '';
        updateOutput();
    }

    // Update output frame
    function updateOutput() {
        const html = document.getElementById('htmlInput').value;
        const css = `<style>${document.getElementById('cssInput').value}</style>`;
        const js = document.getElementById('jsInput').value;
        const outputFrame = document.getElementById('outputFrame').contentWindow.document;
        outputFrame.open();
        outputFrame.write(html + css + `<script>${js}<\/script>`);
        outputFrame.close();
    }

    // Download files
    document.getElementById('downloadBtn').addEventListener('click', () => {
        saveProgress();
        const htmlContent = document.getElementById('htmlInput').value;
        const cssContent = document.getElementById('cssInput').value;
        const jsContent = document.getElementById('jsInput').value;
        const cssFileName = document.getElementById('cssFileName').value || 'style';
        const jsFileName = document.getElementById('jsFileName').value || 'script';
        
        const zip = new JSZip();
        zip.file('index.html', htmlContent);
        if (cssContent) zip.file(`${cssFileName}.css`, cssContent);
        if (jsContent) zip.file(`${jsFileName}.js`, jsContent);
        
        zip.generateAsync({ type: "blob" }).then(function(content) {
            const a = document.createElement('a');
            a.href = URL.createObjectURL(content);
            a.download = 'project.zip';
            a.click();
        });
    });

    // Import files
    document.getElementById('importBtn').addEventListener('click', () => {
        const htmlFile = document.createElement('input');
        htmlFile.type = 'file';
        htmlFile.accept = '.html';
        htmlFile.onchange = e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                document.getElementById('htmlInput').value = reader.result;
                updateOutput();
            };
            reader.readAsText(file);
        };
        htmlFile.click();

        const cssFile = document.createElement('input');
        cssFile.type = 'file';
        cssFile.accept = '.css';
        cssFile.onchange = e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                document.getElementById('cssInput').value = reader.result;
                updateOutput();
            };
            reader.readAsText(file);
        };
        cssFile.click();

        const jsFile = document.createElement('input');
        jsFile.type = 'file';
        jsFile.accept = '.js';
        jsFile.onchange = e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                document.getElementById('jsInput').value = reader.result;
                updateOutput();
            };
            reader.readAsText(file);
        };
        jsFile.click();
    });

    // Add OTF font
    document.getElementById('addFontBtn').addEventListener('click', () => {
        const fontInput = document.getElementById('fontInput');
        if (fontInput.files.length === 0) {
            alert('Please select a font file.');
            return;
        }

        const fontFile = fontInput.files[0];
        const fontName = prompt("Enter a name for the font:");
        if (!fontName) return;

        const reader = new FileReader();
        reader.onload = () => {
            const fontFace = `
                @font-face {
                    font-family: '${fontName}';
                    src: url('${reader.result}') format('opentype');
                }
            `;
            document.getElementById('cssInput').value += fontFace;
            updateOutput();
        };
        reader.readAsDataURL(fontFile);
    });

    // New Project functionality
    document.getElementById('newProjectBtn').addEventListener('click', () => {
        const projectName = prompt("Enter project name:");
        if (!projectName) return;

        const projectItem = document.createElement('div');
        projectItem.className = 'project-title';
        projectItem.innerText = projectName;
        projectItem.onclick = () => loadProgress(projectName);
        document.getElementById('projectList').appendChild(projectItem);

        // Reset inputs
        document.getElementById('htmlInput').value = '';
        document.getElementById('cssInput').value = '';
        document.getElementById('jsInput').value = '';
        document.getElementById('cssFileName').value = '';
        document.getElementById('jsFileName').value = '';
        updateOutput();
    });

    // Event listeners for input changes
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.addEventListener('input', updateOutput);
    });

    // Load progress on page load
    window.onload = () => {
        // Load existing projects from localStorage if any
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.endsWith('_html')) {
                const projectName = key.split('_')[0];
                const projectItem = document.createElement('div');
                projectItem.className = 'project-title';
                projectItem.innerText = projectName;
                projectItem.onclick = () => loadProgress(projectName);
                document.getElementById('projectList').appendChild(projectItem);
            }
        }
    };

    window.onbeforeunload = saveProgress;
</script>

<!-- Include JSZip for downloading files -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

</body>
</html>
